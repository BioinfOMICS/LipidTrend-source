<!DOCTYPE html><html><head><title>R: Fit Linear Model to Individual Channels of Two-Color Data</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>lmscFit {limma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fit Linear Model to Individual Channels of Two-Color Data</h2>

<h3>Description</h3>

<p>Fit a linear model to the individual log-intensities for each gene given a series of two-color arrays</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmscFit(object, design, correlation)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="object">object</code></td>
<td>
<p>an <code><a href="../help/malist.html">MAList</a></code> object or a list from which <code>M</code> and <code>A</code> values may be extracted</p>
</td></tr>
<tr><td><code id="design">design</code></td>
<td>
<p>a numeric matrix containing the design matrix for linear model in terms of the individual channels.
The number of rows should be twice the number of arrays.
The number of columns will determine the number of coefficients estimated for each gene.</p>
</td></tr>
<tr><td><code id="correlation">correlation</code></td>
<td>
<p>numeric value giving the intra-spot correlation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For two color arrays, the channels measured on the same set of arrays are correlated.
The <code>M</code> and <code>A</code> however are uncorrelated for each gene.
This function fits a linear model to the set of M and A-values for each gene after re-scaling the M and A-values to have equal variances.
The input correlation determines the scaling required.
The input correlation is usually estimated using <code><a href="../../limma/help/intraspotCorrelation.html">intraspotCorrelation</a></code> before using <code>lmscFit</code>.
</p>
<p>Missing values in <code>M</code> or <code>A</code> are not allowed.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="../help/marraylm.html">MArrayLM</a></code>
</p>


<h3>Author(s)</h3>

<p>Gordon Smyth</p>


<h3>References</h3>

<p>Smyth, GK (2005). Individual channel analysis of two-colour microarray data.
<em>Proceedings of the 55th Session of the International Statistics Institute</em>, 5-12 April 2005, Sydney, Australia;
Internatational Statistics Institute; Paper 116.
<a href="https://gksmyth.github.io/pubs/ISI2005-116.pdf">https://gksmyth.github.io/pubs/ISI2005-116.pdf</a>
</p>
<p>Smyth, GK, and Altman, NS (2013).
Separate-channel analysis of two-channel microarrays: recovering inter-spot information.
<em>BMC Bioinformatics</em> 14, 165.
<a href="https://doi.org/10.1186/1471-2105-14-165">doi:10.1186/1471-2105-14-165</a>
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/help/lmfit.html">lm.fit</a></code>.
</p>
<p>An overview of methods for single channel analysis in limma is given by <a href="../../limma/help/07.SingleChannel.html">07.SingleChannel</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Subset of data from ApoAI case study in Limma User's Guide
# Avoid non-positive intensities
RG &lt;- backgroundCorrect(RG,method="normexp")
MA &lt;- normalizeWithinArrays(RG)
MA &lt;- normalizeBetweenArrays(MA,method="Aq")
targets &lt;- data.frame(Cy3=I(rep("Pool",6)),Cy5=I(c("WT","WT","WT","KO","KO","KO")))
targets.sc &lt;- targetsA2C(targets)
targets.sc$Target &lt;- factor(targets.sc$Target,levels=c("Pool","WT","KO"))
design &lt;- model.matrix(~Target,data=targets.sc)
corfit &lt;- intraspotCorrelation(MA,design)
fit &lt;- lmscFit(MA,design,correlation=corfit$consensus)
cont.matrix &lt;- cbind(KOvsWT=c(0,-1,1))
fit2 &lt;- contrasts.fit(fit,cont.matrix)
fit2 &lt;- eBayes(fit2)
topTable(fit2,adjust="fdr")

## End(Not run)
</code></pre>

<hr><div style="text-align: center;">[Package <em>limma</em> version 3.66.0 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
