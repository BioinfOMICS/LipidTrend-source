<!DOCTYPE html><html><head><title>R: Fit Linear Model to Microrray Data by Ordinary Least Squares</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>lm.series {limma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fit Linear Model to Microrray Data by Ordinary Least Squares</h2>

<h3>Description</h3>

<p>Fit a linear model genewise to expression data from a series of arrays.
This function uses ordinary least squares and is a utility function for <code>lmFit</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lm.series(M,design=NULL,ndups=1,spacing=1,weights=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="M">M</code></td>
<td>
<p>numeric matrix containing log-ratio or log-expression values for a series of microarrays, rows correspond to genes and columns to arrays</p>
</td></tr>
<tr><td><code id="design">design</code></td>
<td>
<p>numeric design matrix defining the linear model. The number of rows should agree with the number of columns of M. The number of columns will determine the number of coefficients estimated for each gene.</p>
</td></tr>
<tr><td><code id="ndups">ndups</code></td>
<td>
<p>number of duplicate spots. Each gene is printed ndups times in adjacent spots on each array.</p>
</td></tr>
<tr><td><code id="spacing">spacing</code></td>
<td>
<p>the spacing between the rows of <code>M</code> corresponding to duplicate spots, <code>spacing=1</code> for consecutive spots</p>
</td></tr>
<tr><td><code id="weights">weights</code></td>
<td>
<p>an optional numeric matrix of the same dimension as <code>M</code> containing weights for each spot. If it is of different dimension to <code>M</code>, it will be filled out to the same size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a utility function used by the higher level function <code><a href="../../limma/help/lmFit.html">lmFit</a></code>.
Most users should not use this function directly but should use <code><a href="../../limma/help/lmFit.html">lmFit</a></code> instead.
</p>
<p>The linear model is fit for each gene by calling the function <code>lm.fit</code> or <code>lm.wfit</code> from the base library.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>numeric matrix containing the estimated coefficients for each linear model. Same number of rows as <code>M</code>, same number of columns as <code>design</code>.</p>
</td></tr>
<tr><td><code>stdev.unscaled</code></td>
<td>
<p>numeric matrix conformal with <code>coef</code> containing the unscaled standard deviations for the coefficient estimators. The standard errors are given by <code>stdev.unscaled * sigma</code>.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>numeric vector containing the residual standard deviation for each gene.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>numeric vector giving the degrees of freedom corresponding to <code>sigma</code>.</p>
</td></tr>
<tr><td><code>qr</code></td>
<td>
<p>QR-decomposition of <code>design</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gordon Smyth</p>


<h3>See Also</h3>

<p><code><a href="../../stats/help/lmfit.html">lm.fit</a></code>.
</p>
<p>An overview of linear model functions in limma is given by <a href="../../limma/help/06.LinearModels.html">06.LinearModels</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See lmFit for examples
</code></pre>

<hr><div style="text-align: center;">[Package <em>limma</em> version 3.66.0 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
