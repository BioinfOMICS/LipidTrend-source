<!DOCTYPE html><html><head><title>R: Finding overlapping genomic ranges</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>findOverlaps-methods {GenomicRanges}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Finding overlapping genomic ranges</h2>

<h3>Description</h3>

<p>Various methods for finding/counting overlaps between objects containing
genomic ranges. This man page describes the methods that operate on
<a href="../../GenomicRanges/help/GenomicRanges.html">GenomicRanges</a> and <a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> objects.
</p>
<p>NOTE: The <code><a href="../../IRanges/help/findOverlaps.html">findOverlaps</a></code> generic function
and methods for <a href="../../IRanges/help/IntegerRanges.html">IntegerRanges</a> and
<a href="../../IRanges/help/IntegerRangesList.html">IntegerRangesList</a> objects are defined and
documented in the <span class="pkg">IRanges</span> package.
The methods for <a href="../../GenomicAlignments/help/GAlignments.html">GAlignments</a>,
<a href="../../GenomicAlignments/help/GAlignmentPairs.html">GAlignmentPairs</a>, and
<a href="../../GenomicAlignments/help/GAlignmentsList.html">GAlignmentsList</a> objects are defined and
documented in the <span class="pkg">GenomicAlignments</span> package.
</p>
<p><a href="../../GenomicRanges/help/GenomicRanges.html">GenomicRanges</a> and <a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> objects also support
<code>countOverlaps</code>, <code>overlapsAny</code>, and <code>subsetByOverlaps</code> 
thanks to the default methods defined in the <span class="pkg">IRanges</span> package and
to the <code>findOverlaps</code> and <code>countOverlaps</code> methods defined in
this package and documented below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'GenomicRanges,GenomicRanges'
findOverlaps(query, subject,
    maxgap=-1L, minoverlap=0L,
    type=c("any", "start", "end", "within", "equal"),
    select=c("all", "first", "last", "arbitrary"),
    ignore.strand=FALSE)

## S4 method for signature 'GRangesList,GenomicRanges'
findOverlaps(query, subject,
    maxgap=-1L, minoverlap=0L,
    type=c("any", "start", "end", "within", "equal"),
    select=c("all", "first", "last", "arbitrary"),
    ignore.strand=FALSE)

## S4 method for signature 'GenomicRanges,GRangesList'
findOverlaps(query, subject,
    maxgap=-1L, minoverlap=0L,
    type=c("any", "start", "end", "within", "equal"),
    select=c("all", "first", "last", "arbitrary"),
    ignore.strand=FALSE)

## S4 method for signature 'GRangesList,GRangesList'
findOverlaps(query, subject,
    maxgap=-1L, minoverlap=0L,
    type=c("any", "start", "end", "within", "equal"),
    select=c("all", "first", "last", "arbitrary"),
    ignore.strand=FALSE)

## S4 method for signature 'GenomicRanges,GenomicRanges'
countOverlaps(query, subject,
    maxgap=-1L, minoverlap=0L,
    type=c("any", "start", "end", "within", "equal"),
    ignore.strand=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="query">query</code>, <code id="subject">subject</code></td>
<td>

<p>A <a href="../../GenomicRanges/help/GRanges.html">GRanges</a> or <a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> object.
</p>
</td></tr>
<tr><td><code id="maxgap">maxgap</code>, <code id="minoverlap">minoverlap</code>, <code id="type">type</code></td>
<td>

<p>See <code>?<a href="../../IRanges/help/findOverlaps.html">findOverlaps</a></code> in the <span class="pkg">IRanges</span> package
for a description of these arguments.
</p>
<p>IMPORTANT NOTE about how <code>minoverlap</code> is interpreted when
<code>query</code> or <code>subject</code> is a <a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> object:
In this case, <em>the total number of overlapping positions</em> between
a given element in <code>query</code> and a given element in <code>subject</code>
is taken into account. For example, if <code>query</code> is a <a href="../../GenomicRanges/help/GRanges.html">GRanges</a>
object, and <code>subject</code> a <a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> object, then
<code>findOverlaps()</code> will report an overlap between <code>query[i]</code>
(a single range) and <code>subject[[j]]</code> (multiple ranges) only if
the total number of positions in <code>subject[[j]]</code> that overlap with
<code>query[i]</code> is equal to <code>minoverlap</code> or greater. In other words,
the full overlap across all the ranges in <code>subject[[j]]</code> is looked
at. See the Examples section below for an example illustrating this.
</p>
</td></tr>
<tr><td><code id="select">select</code></td>
<td>

<p>When <code>select</code> is <code>"all"</code> (the default), the results are
returned as a Hits object.
Otherwise the returned value is an integer vector parallel to <code>query</code>
(i.e. same length) containing the first, last, or arbitrary overlapping
interval in <code>subject</code>, with <code>NA</code> indicating intervals that did
not overlap any intervals in <code>subject</code>.
</p>
</td></tr>
<tr><td><code id="ignore.strand">ignore.strand</code></td>
<td>

<p>When set to <code>TRUE</code>, the strand information is ignored in the
overlap calculations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the query and the subject are <a href="../../GenomicRanges/help/GRanges.html">GRanges</a> or
<a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> objects, <code>findOverlaps</code> uses the triplet
(sequence name, range, strand) to determine which features (see
paragraph below for the definition of feature) from the <code>query</code>
overlap which features in the <code>subject</code>, where a strand value
of <code>"*"</code> is treated as occurring on both the <code>"+"</code> and
<code>"-"</code> strand.
An overlap is recorded when a feature in the <code>query</code> and a feature
in the <code>subject</code> have the same sequence name, have a compatible
pairing of strands (e.g. <code>"+"</code>/<code>"+"</code>, <code>"-"</code>/<code>"-"</code>,
<code>"*"</code>/<code>"+"</code>, <code>"*"</code>/<code>"-"</code>, etc.), and satisfy the
interval overlap requirements.
</p>
<p>In the context of <code>findOverlaps</code>, a feature is a collection of
ranges that are treated as a single entity. For <a href="../../GenomicRanges/help/GRanges.html">GRanges</a> objects,
a feature is a single range; while for <a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> objects,
a feature is a list element containing a set of ranges. In the results,
the features are referred to by number, which run from 1 to
<code>length(query)</code>/<code>length(subject)</code>.
</p>
<p>For <code>type="equal"</code> with GRangesList objects, <code>query[[i]]</code>
matches <code>subject[[j]]</code> iff for each range in <code>query[[i]]</code>
there is an identical range in <code>subject[[j]]</code>, and vice versa.
</p>


<h3>Value</h3>

<p>For <code>findOverlaps</code>: either a <a href="../../S4Vectors/help/Hits.html">Hits</a> object when
<code>select="all"</code> or an integer vector otherwise. 
</p>
<p>For <code>countOverlaps</code>: an integer vector containing the tabulated
query overlap hits.
</p>


<h3>Author(s)</h3>

<p>P. Aboyoun, S. Falcon, M. Lawrence, and H. Pag√®s</p>


<h3>See Also</h3>


<ul>
<li><p> The <a href="../../S4Vectors/help/Hits.html">Hits</a> class in the <span class="pkg">S4Vectors</span> package
for representing a set of hits between 2 vector-like objects.
</p>
</li>
<li><p> The <code><a href="../../IRanges/help/findOverlaps.html">findOverlaps</a></code> generic function defined
in the <span class="pkg">IRanges</span> package.
</p>
</li>
<li><p> The <a href="../../GenomicRanges/help/GNCList.html">GNCList</a> constructor and class for preprocessing and
representing a <a href="../../GenomicRanges/help/GenomicRanges.html">GenomicRanges</a> or object as a data structure
based on Nested Containment Lists.
</p>
</li>
<li><p> The <a href="../../GenomicRanges/help/GRanges.html">GRanges</a> and <a href="../../GenomicRanges/help/GRangesList.html">GRangesList</a> classes.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## ---------------------------------------------------------------------
## BASIC EXAMPLES
## ---------------------------------------------------------------------

## GRanges object:
gr &lt;- GRanges(
        seqnames=Rle(c("chr1", "chr2", "chr1", "chr3"), c(1, 3, 2, 4)),
        ranges=IRanges(1:10, width=10:1, names=head(letters,10)),
        strand=Rle(strand(c("-", "+", "*", "+", "-")), c(1, 2, 2, 3, 2)),
        score=1:10,
        GC=seq(1, 0, length=10)
      )
gr

## GRangesList object:
gr1 &lt;- GRanges(seqnames="chr2", ranges=IRanges(4:3, 6),
               strand="+", score=5:4, GC=0.45)
gr2 &lt;- GRanges(seqnames=c("chr1", "chr1"),
               ranges=IRanges(c(7,13), width=3),
               strand=c("+", "-"), score=3:4, GC=c(0.3, 0.5))
gr3 &lt;- GRanges(seqnames=c("chr1", "chr2"),
               ranges=IRanges(c(1, 4), c(3, 9)),
               strand=c("-", "-"), score=c(6L, 2L), GC=c(0.4, 0.1))
grl &lt;- GRangesList("gr1"=gr1, "gr2"=gr2, "gr3"=gr3)

## Overlapping two GRanges objects:
table(!is.na(findOverlaps(gr, gr1, select="arbitrary")))
countOverlaps(gr, gr1)
findOverlaps(gr, gr1)
subsetByOverlaps(gr, gr1)

countOverlaps(gr, gr1, type="start")
findOverlaps(gr, gr1, type="start")
subsetByOverlaps(gr, gr1, type="start")

findOverlaps(gr, gr1, select="first")
findOverlaps(gr, gr1, select="last")

findOverlaps(gr1, gr)
findOverlaps(gr1, gr, type="start")
findOverlaps(gr1, gr, type="within")
findOverlaps(gr1, gr, type="equal")

## ---------------------------------------------------------------------
## MORE EXAMPLES
## ---------------------------------------------------------------------

table(!is.na(findOverlaps(gr, gr1, select="arbitrary")))
countOverlaps(gr, gr1)
findOverlaps(gr, gr1)
subsetByOverlaps(gr, gr1)

## Overlaps between a GRanges and a GRangesList object:

table(!is.na(findOverlaps(grl, gr, select="first")))
countOverlaps(grl, gr)
findOverlaps(grl, gr)
subsetByOverlaps(grl, gr)
countOverlaps(grl, gr, type="start")
findOverlaps(grl, gr, type="start")
subsetByOverlaps(grl, gr, type="start")
findOverlaps(grl, gr, select="first")

table(!is.na(findOverlaps(grl, gr1, select="first")))
countOverlaps(grl, gr1)
findOverlaps(grl, gr1)
subsetByOverlaps(grl, gr1)
countOverlaps(grl, gr1, type="start")
findOverlaps(grl, gr1, type="start")
subsetByOverlaps(grl, gr1, type="start")
findOverlaps(grl, gr1, select="first")

## Overlaps between two GRangesList objects:
countOverlaps(grl, rev(grl))
findOverlaps(grl, rev(grl))
subsetByOverlaps(grl, rev(grl))

## ---------------------------------------------------------------------
## INTERPRETATION OF 'minoverlap' WHEN 'query' OR 'subject' IS A
## GRangesList OBJECT
## ---------------------------------------------------------------------
gr1 &lt;- GRanges("chr5:1-26")
gr2 &lt;- GRanges("chr5:31-40")
gr3 &lt;- c(GRanges("chr5:11-20"), gr2)
grl123 &lt;- GRangesList(gr1, gr2, gr3)
grl123

query &lt;- GRanges("chr5:17-35")

findOverlaps(query, grl123[[1]], minoverlap=8)  # 1 hit
findOverlaps(query, grl123[[2]], minoverlap=8)  # no hit
findOverlaps(query, grl123[[3]], minoverlap=8)  # no hit

## Using GRangesList object 'grl123' as the subject:
findOverlaps(query, grl123, minoverlap=8)

## As we can see, a hit is reported with the 3rd element in the subject.
## That's because the total number of positions in this overlap is 9:
## - positions 17 to 20 in the first range of grl123[[3]], so 4 positions
## - positions 31 to 35 in its second range, so 5 positions

## Sanity checks:
hits &lt;- findOverlaps(query, grl123[[1]], minoverlap=8)
stopifnot(length(hits) == 1)
hits &lt;- findOverlaps(query, grl123[[2]], minoverlap=8)
stopifnot(length(hits) == 0)
hits &lt;- findOverlaps(query, grl123[[3]], minoverlap=8)
stopifnot(length(hits) == 0)
hits &lt;- findOverlaps(query, grl123, minoverlap=8)
stopifnot(identical(subjectHits(hits), c(1L, 3L)))
hits &lt;- findOverlaps(query, grl123, minoverlap=9)
stopifnot(identical(subjectHits(hits), c(1L, 3L)))
hits &lt;- findOverlaps(query, grl123, minoverlap=10)
stopifnot(identical(subjectHits(hits), 1L))
hits &lt;- findOverlaps(query, grl123, minoverlap=11)
stopifnot(length(hits) == 0)
</code></pre>

<hr><div style="text-align: center;">[Package <em>GenomicRanges</em> version 1.62.1 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
