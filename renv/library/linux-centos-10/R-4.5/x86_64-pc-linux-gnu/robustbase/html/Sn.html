<!DOCTYPE html><html><head><title>R: Robust Location-Free Scale Estimate More Efficient than MAD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>Sn {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Robust Location-Free Scale Estimate More Efficient than MAD</h2>

<h3>Description</h3>

<p>Compute the robust scale estimator <code class="reqn">S_n</code>, an efficient
alternative to the MAD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sn(x, constant = 1.1926, finite.corr = missing(constant), na.rm = FALSE)

s_Sn(x, mu.too = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x">x</code></td>
<td>
<p>numeric vector of observations.</p>
</td></tr>
<tr><td><code id="constant">constant</code></td>
<td>
<p>number by which the result is multiplied; the default
achieves consisteny for normally distributed data.</p>
</td></tr>
<tr><td><code id="finite.corr">finite.corr</code></td>
<td>
<p>logical indicating if the finite sample bias
correction factor should be applied.  Default to <code>TRUE</code> unless
<code>constant</code> is specified.</p>
</td></tr>
<tr><td><code id="na.rm">na.rm</code></td>
<td>
<p>logical specifying if missing values (<code><a href="../../base/html/NA.html">NA</a></code>)
should be removed from <code>x</code> before further computation.  If false
as by default, and if there are <code>NA</code>s, i.e., <code>if(anyNA(x))</code>,
the result will be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="mu.too">mu.too</code></td>
<td>
<p>logical indicating if the <code><a href="../../stats/help/median.html">median</a>(x)</code> should
also be returned for <code>s_Sn()</code>.</p>
</td></tr>
<tr><td><code id="...">...</code></td>
<td>
<p>potentially further arguments for <code>s_Sn()</code> passed to
<code>Sn()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>............  FIXME ........
</p>


<h3>Value</h3>

<p><code>Sn()</code> returns a number, the <code class="reqn">S_n</code> robust scale estimator, scaled to be
consistent for <code class="reqn">\sigma^2</code> and i.i.d. Gaussian observations,
optionally bias corrected for finite samples.
</p>
<p><code>s_Sn(x, mu.too=TRUE)</code> returns a length-2 vector with location
(<code class="reqn">\mu</code>) and scale; this is typically only useful for
<code><a href="../../robustbase/help/covOGK.html">covOGK</a>(*, sigmamu = s_Sn)</code>.
</p>


<h3>Author(s)</h3>

<p>Original Fortran code:
Christophe Croux and Peter Rousseeuw <a href="mailto:rousse@wins.uia.ac.be">rousse@wins.uia.ac.be</a>.
<br>
Port to C and R: Martin Maechler, <a href="mailto:maechler@R-project.org">maechler@R-project.org</a>
</p>


<h3>References</h3>

<p>Rousseeuw, P.J. and Croux, C. (1993)
Alternatives to the Median Absolute Deviation,
<em>Journal of the American Statistical Association</em> <b>88</b>, 1273&ndash;1283.
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/help/mad.html">mad</a></code> for the &lsquo;most robust&rsquo; but much
less efficient scale estimator;
<code><a href="../../robustbase/help/Qn.html">Qn</a></code> for a similar more efficient but slower alternative;
<code><a href="../../robustbase/help/scaleTau2.html">scaleTau2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:10, 100+1:9)# 9 outliers out of 19
Sn(x)
Sn(x, c=1)# 9
Sn(x[1:18], c=1)# 9
set.seed(153)
x &lt;- sort(c(rnorm(80), rt(20, df = 1)))
s_Sn(x, mu.too=TRUE)

(s &lt;- Sn(c(1:4, 10, Inf, NA), na.rm=TRUE))
stopifnot(is.finite(s), all.equal(3.5527554, s, tol=1e-10))
</code></pre>

<hr><div style="text-align: center;">[Package <em>robustbase</em> version 0.99-7 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
