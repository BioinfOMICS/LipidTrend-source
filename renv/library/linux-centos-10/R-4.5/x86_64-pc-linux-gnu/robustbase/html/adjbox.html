<!DOCTYPE html><html><head><title>R: Plot an Adjusted Boxplot for Skew Distributions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>adjbox {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot an Adjusted Boxplot for Skew Distributions</h2>

<h3>Description</h3>

<p>Produces boxplots adjusted for skewed distributions as proposed in
Hubert and Vandervieren (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjbox(x, ...)

## S3 method for class 'formula'
adjbox(formula, data = NULL, ..., subset, na.action = NULL)

## Default S3 method:
adjbox(x, ..., range = 1.5, doReflect = FALSE,
        width = NULL, varwidth = FALSE,
        notch = FALSE, outline = TRUE, names, plot = TRUE,
        border = par("fg"), col = NULL, log = "",
        pars = list(boxwex = 0.8, staplewex = 0.5, outwex = 0.5),
        horizontal = FALSE, add = FALSE, at = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formula">formula</code></td>
<td>
<p>a formula, such as <code>y ~ grp</code>, where <code>y</code> is a
numeric vector of data values to be split into groups according to
the grouping variable <code>grp</code> (usually a factor).</p>
</td></tr>
<tr><td><code id="data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.</p>
</td></tr>
<tr><td><code id="subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td></tr>
<tr><td><code id="na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to ignore missing
values in either the response or the group.</p>
</td></tr>
<tr><td><code id="x">x</code></td>
<td>
<p>for specifying data from which the boxplots are to be
produced. Either a numeric vector, or a single list containing such
vectors. Additional unnamed arguments specify further data
as separate vectors (each corresponding to a component boxplot).
<code><a href="../../base/html/NA.html">NA</a></code>s are allowed in the data.</p>
</td></tr>
<tr><td><code id="...">...</code></td>
<td>
<p>For the <code>formula</code> method, named arguments to be passed to
the default method.
</p>
<p>For the default method, unnamed arguments are additional data
vectors (unless <code>x</code> is a list when they are ignored),
and named arguments are arguments and graphical parameters to be
passed to <code><a href="../../graphics/html/bxp.html">bxp</a></code> in addition to the ones
given by argument <code>pars</code> (and override those in <code>pars</code>).
</p>
</td></tr>
<tr><td><code id="range">range</code></td>
<td>
<p>this determines how far the plot whiskers extend out
from the box, and is simply passed as argument <code>coef</code> to
<code><a href="../../robustbase/help/adjboxStats.html">adjboxStats</a>()</code>.  If <code>range</code> is positive, the
whiskers extend to the most extreme data point which is no more than
<code>range</code> times the interquartile range from the box.  A value
of zero causes the whiskers to extend to the data extremes.</p>
</td></tr>
<tr><td><code id="doReflect">doReflect</code></td>
<td>
<p>logical indicating if the MC should also be
computed on the <em>reflected</em> sample <code>-x</code>, and be averaged,
see <code><a href="../../robustbase/help/mc.html">mc</a></code>.</p>
</td></tr>
<tr><td><code id="width">width</code></td>
<td>
<p>a vector giving the relative widths of the boxes making
up the plot.</p>
</td></tr>
<tr><td><code id="varwidth">varwidth</code></td>
<td>
<p>if <code>varwidth</code> is <code>TRUE</code>, the boxes are
drawn with widths proportional to the square-roots of the number
of observations in the groups.</p>
</td></tr>
<tr><td><code id="notch">notch</code></td>
<td>
<p>if <code>notch</code> is <code>TRUE</code>, a notch is drawn in
each side of the boxes.  If the notches of two plots do not
overlap this is &lsquo;strong evidence&rsquo; that the two medians differ
(Chambers <em>et al.</em>, 1983, p. 62).  See <code><a href="../../grDevices/html/boxplot.stats.html">boxplot.stats</a></code>
for the calculations used.</p>
</td></tr>
<tr><td><code id="outline">outline</code></td>
<td>
<p>if <code>outline</code> is not true, the outliers are
not drawn (as points whereas S+ uses lines).</p>
</td></tr>
<tr><td><code id="names">names</code></td>
<td>
<p>group labels which will be printed under each boxplot.</p>
</td></tr>
<tr><td><code id="boxwex">boxwex</code></td>
<td>
<p>a scale factor to be applied to all boxes.  When there
are only a few groups, the appearance of the plot can be improved
by making the boxes narrower.</p>
</td></tr>
<tr><td><code id="staplewex">staplewex</code></td>
<td>
<p>staple line width expansion, proportional to box
width.</p>
</td></tr>
<tr><td><code id="outwex">outwex</code></td>
<td>
<p>outlier line width expansion, proportional to box
width.</p>
</td></tr>
<tr><td><code id="plot">plot</code></td>
<td>
<p>if <code>TRUE</code> (the default) then a boxplot is
produced.  If not, the summaries which the boxplots are based on
are returned.</p>
</td></tr>
<tr><td><code id="border">border</code></td>
<td>
<p>an optional vector of colors for the outlines of the
boxplots.  The values in <code>border</code> are recycled if the
length of <code>border</code> is less than the number of plots.</p>
</td></tr>
<tr><td><code id="col">col</code></td>
<td>
<p>if <code>col</code> is non-null it is assumed to contain colors
to be used to colour the bodies of the box plots. By default they
are in the background colour.</p>
</td></tr>
<tr><td><code id="log">log</code></td>
<td>
<p>character indicating if x or y or both coordinates should
be plotted in log scale.</p>
</td></tr>
<tr><td><code id="pars">pars</code></td>
<td>
<p>a list of (potentially many) more graphical parameters,
e.g., <code>boxwex</code> or <code>outpch</code>; these are passed to
<code><a href="../../graphics/html/bxp.html">bxp</a></code> (if <code>plot</code> is true); for details, see there.</p>
</td></tr>
<tr><td><code id="horizontal">horizontal</code></td>
<td>
<p>logical indicating if the boxplots should be
horizontal; default <code>FALSE</code> means vertical boxes.</p>
</td></tr>
<tr><td><code id="add">add</code></td>
<td>
<p>logical, if true <em>add</em> boxplot to current plot.</p>
</td></tr>
<tr><td><code id="at">at</code></td>
<td>
<p>numeric vector giving the locations where the boxplots should
be drawn, particularly when <code>add = TRUE</code>;
defaults to <code>1:n</code> where <code>n</code> is the number of boxes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>adjbox</code> currently has a default method
(<code>adjbox.default</code>) and a formula interface (<code>adjbox.formula</code>).
</p>
<p>If multiple groups are supplied either as multiple arguments or via a
formula, parallel boxplots will be plotted, in the order of the
arguments or the order of the levels of the factor (see
<code><a href="../../base/html/factor.html">factor</a></code>).
</p>
<p>Missing values are ignored when forming boxplots.
</p>
<p>Extremes of the upper and whiskers of the adjusted boxplots are
computed using the medcouple (<code><a href="../../robustbase/help/mc.html">mc</a>()</code>), a robust measure of
skewness. For details, cf. TODO 
</p>


<h3>Value</h3>

<p>A <code><a href="../../base/html/list.html">list</a></code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>stats</code></td>
<td>
<p>a matrix, each column contains the extreme of the lower
whisker, the lower hinge, the median, the upper hinge and the extreme of
the upper whisker for one group/plot.  If all the inputs have the same
class attribute, so will this component.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a vector with the number of observations in each group.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>a matrix where each column contains the lower and upper
extremes of the notch.</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>the values of any data points which lie beyond the extremes
of the whiskers.</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>a vector of the same length as out whose elements
indicate to which group the outlier belongs.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>a vector of names for the groups.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> The code and documentation only slightly modifies the code of
<code><a href="../../graphics/html/boxplot.html">boxplot.default</a></code>, <code>boxplot.formula</code> and
<code><a href="../../grDevices/html/boxplot.stats.html">boxplot.stats</a></code>
</p>


<h3>Author(s)</h3>

<p> R Core Development Team, slightly adapted by Tobias Verbeke </p>


<h3>References</h3>

<p>Hubert, M. and Vandervieren, E. (2008).
An adjusted boxplot for skewed distributions,
<em>Computational Statistics and Data Analysis</em> <b>52</b>, 5186&ndash;5201.
<a href="https://doi.org/10.1016/j.csda.2007.11.008">doi:10.1016/j.csda.2007.11.008</a>
</p>


<h3>See Also</h3>

<p>The medcouple, <code><a href="../../robustbase/help/mc.html">mc</a></code>; <code><a href="../../graphics/html/boxplot.html">boxplot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("boot")) {
 ### Hubert and Vandervieren (2008), Fig. 5.%(2006): p. 10, Fig. 4.
 data(coal, package = "boot")
 coaldiff &lt;- diff(coal$date)
 op &lt;- par(mfrow = c(1,2))
 boxplot(coaldiff, main = "Original Boxplot")
 adjbox(coaldiff, main  = "Adjusted Boxplot")
 par(op)
}

### Hubert and Vandervieren (2008), p. 11, Fig. 7a -- enhanced
op &lt;- par(mfrow = c(2,2), mar = c(1,3,3,1), oma = c(0,0,3,0))
with(condroz, {
 boxplot(Ca, main = "Original Boxplot")
 adjbox (Ca, main = "Adjusted Boxplot")
 boxplot(Ca, main = "Original Boxplot [log]", log = "y")
 adjbox (Ca, main = "Adjusted Boxplot [log]", log = "y")
})
mtext("'Ca' from data(condroz)",
      outer=TRUE, font = par("font.main"), cex = 2)
par(op)
</code></pre>

<hr><div style="text-align: center;">[Package <em>robustbase</em> version 0.99-7 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
