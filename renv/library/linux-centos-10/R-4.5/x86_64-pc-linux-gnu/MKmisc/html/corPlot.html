<!DOCTYPE html><html><head><title>R: Plot of similarity matrix based on correlation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>corPlot {MKmisc}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2> Plot of similarity matrix based on correlation </h2>

<h3>Description</h3>

<p>Plot of similarity matrix. This function is a slight modification of function
<code>plot.cor</code> of the archived package <code>"sma"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corPlot(x, new = FALSE, col, minCor, 
          labels = FALSE, lab.both.axes = FALSE, labcols = "black", 
          title = "", cex.title = 1.2, 
          protocol = FALSE, cex.axis = 0.8, 
          cex.axis.bar = 1, signifBar = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x">x</code></td>
<td>
<p> data or correlation matrix, respectively </p>
</td></tr>
<tr><td><code id="new">new</code></td>
<td>
<p> If <code>new=FALSE</code>, <code>x</code> must already be a correlation matrix. 
If <code>new=TRUE</code>, the correlation matrix for the columns of 
<code>x</code> is computed and displayed in the image. </p>
</td></tr>
<tr><td><code id="col">col</code></td>
<td>
<p> colors palette for image. If missing, the <code>RdYlGn</code> palette
of <code>RColorBrewer</code> is used. </p>
</td></tr>
<tr><td><code id="minCor">minCor</code></td>
<td>
<p>numeric value in [-1,1], used to adjust <code>col</code></p>
</td></tr>
<tr><td><code id="labels">labels</code></td>
<td>
<p> vector of character strings to be placed at the tickpoints,
labels for the columns of <code>x</code>. </p>
</td></tr>
<tr><td><code id="lab.both.axes">lab.both.axes</code></td>
<td>
<p> logical, display labels on both axes </p>
</td></tr>
<tr><td><code id="labcols">labcols</code></td>
<td>
<p> colors to be used for the labels of the columns of <code>x</code>.
<code>labcols</code> can have either length 1, in which case all 
the labels are displayed using the same color, or the same 
length as <code>labels</code>, in which case a color is specified 
for the label of each column of <code>x</code>. </p>
</td></tr>
<tr><td><code id="title">title</code></td>
<td>
<p> character string, overall title for the plot. </p>
</td></tr>
<tr><td><code id="cex.title">cex.title</code></td>
<td>
<p> A numerical value giving the amount by which plotting text
and symbols should be magnified relative to the default;
cf. <code><a href="../../graphics/help/par.html">par</a></code>, <code>cex.main</code>. </p>
</td></tr>
<tr><td><code id="protocol">protocol</code></td>
<td>
<p> logical, display color bar without numbers </p>
</td></tr>
<tr><td><code id="cex.axis">cex.axis</code></td>
<td>
<p> The magnification to be used for axis annotation relative to the 
current setting of 'cex'; cf. <code><a href="../../graphics/help/par.html">par</a></code>.</p>
</td></tr>
<tr><td><code id="cex.axis.bar">cex.axis.bar</code></td>
<td>
<p> The magnification to be used for axis annotation of the color 
bar relative to the current setting of 'cex'; cf. 
<code><a href="../../graphics/help/par.html">par</a></code>.</p>
</td></tr>
<tr><td><code id="signifBar">signifBar</code></td>
<td>
<p> integer indicating the precision to be used for the bar.</p>
</td></tr>
<tr><td><code id="...">...</code></td>
<td>
<p> graphical parameters may also be supplied as arguments to the
function (see <code><a href="../../graphics/help/par.html">par</a></code>). For comparison purposes, 
it is good to set <code>zlim=c(-1,1)</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions generates the so called similarity matrix (based on correlation) 
for a microarray experiment. 
</p>
<p>If <code>min(x)</code>, respectively <code>min(cor(x))</code> is smaller than <code>minCor</code>, 
the colors in <code>col</code> are adjusted such that the minimum correlation value 
which is color coded is equal to <code>minCor</code>.
</p>


<h3>Value</h3>

<p><code>invisible()</code>
</p>


<h3>Note</h3>

<p>A first version of this function appeared in package SLmisc.
</p>


<h3>Author(s)</h3>

<p> Matthias Kohl <a href="mailto:Matthias.Kohl@stamats.de">Matthias.Kohl@stamats.de</a></p>


<h3>References</h3>

 
<p>Sandrine Dudoit, Yee Hwa (Jean) Yang, Benjamin Milo Bolstad and with 
contributions from Natalie Thorne, Ingrid Loennstedt and Jessica Mar.
sma: Statistical Microarray Analysis.<br>
http://www.stat.berkeley.edu/users/terry/zarray/Software/smacode.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## only a dummy example
M &lt;- matrix(rnorm(1000), ncol = 20)
colnames(M) &lt;- paste("Sample", 1:20)
M.cor &lt;- cor(M)

corPlot(M.cor, minCor = min(M.cor))
corPlot(M.cor, minCor = min(M.cor), lab.both.axes = TRUE)
corPlot(M.cor, minCor = min(M.cor), protocol = TRUE)
corPlot(M.cor, minCor = min(M.cor), signifBar = 1)
</code></pre>

<hr><div style="text-align: center;">[Package <em>MKmisc</em> version 1.9 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
