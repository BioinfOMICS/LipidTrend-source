<!DOCTYPE html><html><head><title>R: Randomized Quantile Residuals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>qresiduals {statmod}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Randomized Quantile Residuals</h2>

<h3>Description</h3>

<p>Compute randomized quantile residuals for generalized linear models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>qresiduals(glm.obj,dispersion=NULL)
qresid(glm.obj,dispersion=NULL)
qres.binom(glm.obj)
qres.pois(glm.obj)
qres.nbinom(glm.obj)
qres.gamma(glm.obj,dispersion=NULL)
qres.invgauss(glm.obj,dispersion=NULL)
qres.tweedie(glm.obj,dispersion=NULL)
qres.default(glm.obj,dispersion=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glm.obj">glm.obj</code></td>
<td>
<p>Object of class <code>glm</code>. The generalized linear model family is assumed to be binomial for <code>qres.binom</code>, poisson for
<code>qres.pois</code>, negative binomial for <code>qres.nbinom</code>, Gamma for
<code>qres.gamma</code>, inverse Gaussian for <code>qres.invgauss</code> or
tweedie for <code>qres.tweedie</code>.</p>
</td></tr>
<tr><td><code id="dispersion">dispersion</code></td>
<td>
<p>a positive real number. Specifies the value of the
dispersion parameter for a Gamma or inverse Gaussian generalized linear
model if known. If <code>NULL</code>, the dispersion will be estimated by its
Pearson estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quantile residuals are based on the idea of inverting the
estimated distribution function for each observation to
obtain exactly standard normal residuals. In the case of
discrete distributions, such as the binomial and Poisson,
some randomization is introduced to produce continuous
normal residuals. Quantile residuals are the residuals of
choice for generalized linear models in large dispersion
situations when the deviance and Pearson residuals can be
grossly non-normal. Quantile residuals are the only
useful residuals for binomial or Poisson data when the
response takes on only a small number of distinct values.
</p>


<h3>Value</h3>

<p>Numeric vector of standard normal quantile residuals.</p>


<h3>Author(s)</h3>

<p>Gordon Smyth</p>


<h3>References</h3>

<p>Dunn, K. P., and Smyth, G. K. (1996). Randomized quantile residuals. <em>Journal of Computational and Graphical Statistics</em> <b>5</b>, 1-10.
<a href="http://www.statsci.org/smyth/pubs/residual.html">http://www.statsci.org/smyth/pubs/residual.html</a>
</p>
<p>Dunn, PK, and Smyth, GK (2018).
<em>Generalized linear models with examples in R</em>. Springer, New York, NY.
<a href="https://doi.org/10.1007/978-1-4419-0118-7">doi:10.1007/978-1-4419-0118-7</a>
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/glm.summaries.html">residuals.glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Poisson example: quantile residuals show no granularity
y &lt;- rpois(20,lambda=4)
x &lt;- 1:20
fit &lt;- glm(y~x, family=poisson)
qr &lt;- qresiduals(fit)
qqnorm(qr)
abline(0,1)

#  Gamma example:
#  Quantile residuals are nearly normal while usual resids are not
y &lt;- rchisq(20, df=1)
fit &lt;- glm(y~1, family=Gamma)
qr &lt;- qresiduals(fit, dispersion=2)
qqnorm(qr)
abline(0,1)

#  Negative binomial example:
if(require("MASS")) {
fit &lt;- glm(Days~Age,family=negative.binomial(2),data=quine)
summary(qresiduals(fit))
fit &lt;- glm.nb(Days~Age,link=log,data = quine)
summary(qresiduals(fit))
}
</code></pre>

<hr><div style="text-align: center;">[Package <em>statmod</em> version 1.5.1 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
