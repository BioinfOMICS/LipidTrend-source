<!DOCTYPE html><html><head><title>R: Exact Binomial Tests For Comparing Two SAGE Libraries...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script>
const macros = { "\\R": "\\textsf{R}", "\\mbox": "\\text", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css">
</head><body><div class="container"><main>

<table style="width: 100%;"><tr><td>sage.test {statmod}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Exact Binomial Tests For Comparing Two SAGE Libraries (Obsolete)</h2>

<h3>Description</h3>

<p>Computes p-values for differential abundance for each tag between two digital libraries,
conditioning on the total count for each tag.
The counts in each group as a proportion of the whole are assumed to follow a binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sage.test(x, y, n1=sum(x), n2=sum(y))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x">x</code></td>
<td>
<p>integer vector giving counts in first library.
Non-integer values are rounded to the nearest integer.</p>
</td></tr>
<tr><td><code id="y">y</code></td>
<td>
<p>integer vector giving counts in second library.
Non-integer values are rounded to the nearest integer.</p>
</td></tr>
<tr><td><code id="n1">n1</code></td>
<td>
<p>total number of tags in first library.
Non-integer values are rounded to the nearest integer.</p>
</td></tr>
<tr><td><code id="n2">n2</code></td>
<td>
<p>total number of tags in second library.
Non-integer values are rounded to the nearest integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function was originally written for comparing SAGE libraries (a method for counting the frequency of sequence tags in samples of RNA).
It can however be used for comparing any two digital libraries from RNA-Seq, ChIP-Seq or other technologies with respect to technical variation.
</p>
<p>An exact two-sided binomial test is computed for each tag.
This test is closely related to Fisher's exact test for 2x2 contingency tables but, unlike Fisher's test, it conditions on the total number of counts for each tag.
The null hypothesis is that the expected counts are in the same proportions as the library sizes, i.e., that the binomial probability for the first library is <code>n1/(n1+n2)</code>.
</p>
<p>The two-sided rejection region is chosen analogously to Fisher's test.
Specifically, the rejection region consists of those values with smallest probabilities
under the null hypothesis.
</p>
<p>When the counts are reasonably large, the binomial test, Fisher's test and Pearson's chisquare all give the same results.
When the counts are smaller, the binomial test is usually to be preferred in this context.
</p>
<p>This function is a later version of the earlier <code>sage.test</code> function in the sagenhaft Bioconductor package.
This function has been made obsolete by <code>binomTest</code> in the edgeR package.
</p>


<h3>Value</h3>

<p>Numeric vector of p-values.
</p>


<h3>Note</h3>

<p>This function is kept in the statmod package so as not to break code that depends on it
but it has been replaced by <code>binomTest</code> in the edgeR Bioconductor package and 
is no longer updated.
It may be removed in a later release of this package.
</p>


<h3>Author(s)</h3>

<p>Gordon Smyth</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Binomial_test">https://en.wikipedia.org/wiki/Binomial_test</a>
</p>
<p><a href="https://en.wikipedia.org/wiki/Fisher's_exact_test">https://en.wikipedia.org/wiki/Fisher's_exact_test</a>
</p>
<p><a href="https://en.wikipedia.org/wiki/Serial_analysis_of_gene_expression">https://en.wikipedia.org/wiki/Serial_analysis_of_gene_expression</a>
</p>
<p><a href="https://en.wikipedia.org/wiki/RNA-Seq">https://en.wikipedia.org/wiki/RNA-Seq</a>
</p>


<h3>See Also</h3>

<p>The <code>binomTest</code> function in the <a href="https://doi.org/doi:10.18129/B9.bioc.edgeR">edgeR</a> package on Bioconductor is a newer and better version of this function.
</p>
<p><code><a href="../../stats/html/binom.test.html">binom.test</a></code> in the stats package performs univariate binomial tests.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sage.test(c(0,5,10),c(0,30,50),n1=10000,n2=15000)
#  Univariate equivalents:
binom.test(5,5+30,p=10000/(10000+15000))$p.value
binom.test(10,10+50,p=10000/(10000+15000))$p.value
</code></pre>

<hr><div style="text-align: center;">[Package <em>statmod</em> version 1.5.1 <a href="00Index.html">Index</a>]</div></main>

</div>
</body></html>
